# iherbProductScrapper

iherb-scraper is a scraper that scrapes iherb.com for product details 


## Requirements

1. **Chrome version 84**

If you have any other version (83 or 85) then download the respective ChromeDriver using the following links:	

> Chromedriver v83: https://chromedriver.storage.googleapis.com/index.html?path=83.0.4103.39/	

> Chromedriver v85: https://chromedriver.storage.googleapis.com/index.html?path=85.0.4183.87/	

2. **Python 3** 	

To check, if python is installed, type <code>python</code> in the command line. If this opens <code>python3</code> interpreter then are good else install <code>python3</code> using [this](https://www.python.org/downloads/) link.

## Installation

1. Download all the files of this repository by using [this](https://github.com/itl-projects/iherbProductScrapper/archive/master.zip) link.

2. Extract the zip file just downloaded and make sure the directory structure is as follows:


    ├── chromedriver.exe               
    ├── iherb_scraper.py                                        
    ├── requirements.txt                  
    └── README.md

3. Now, open the windows command line and make sure you have <code>python3</code> installed. 


4. Navigate to the directory where the extracted folder is located. To navigate, copy the folder path and type.

```bash
cd <copied_path>
```

4. Use the package manager [pip](https://pip.pypa.io/en/stable/) to install the dependencies.

```bash
pip install -r requirements.txt
```

-------------------------------------------------------------------------------------------------------------------------------

## Usage

1. After all the previous steps have been completed. Run the following command to execute the script.

```
python iherb_scraper.py
```
2. If the script executes without any error then you should get a prompt like this:

```
Enter the number of records you want to fetch: 
```

Now, you can enter the number of records you want to fetch.

3. Now press enter and you should get a message saying <code> Fetching Started! </code> and when the script finishes running, you will get a message saying <code>Fetching Complete.</code>
-------------------------------------------------------------------------------------------------------------------------------

## Script Results

The script will output the following things in the same directory where the script is located.

1. **images** - This folder contains high-resolution images of all the product images available on iherb product page. 

The naming convention followed for image files:

``` 
product_code-image_number.jpg
```

2. **app.log** - This is a log file for the script to monitor what action is being performed when in the script. 

Each line in app.log follows the following format :

```
time_of_action - action_performed
```

3. **product_details.csv** - This is a .csv file that contains all the data being fetched. 

4. **completed.txt** - This file contains the <code>product_code</code> and <code>product_name</code> to specify the products already been downloaded.

<hr>

## iherb Update 1

This has script has an additional functionality of updating already fetched products in a CSV file on demand. It also maintains a file <code>last_index.txt</code> which stores the last fetched product index in CSV file to skip the already updated records. 

**Note:** : To updated from start, delete the last_index.txt file if made by the script from previous runs.

<hr>

## iherb Update 2

There were some collapsing issues with CSV file due to huge text data in <code>product_description</code>. So, to solve that, run <code>utility.py</code> on the already fetched CSV file and it will format all the cells to fit the width of the <code>product_description</code>. The output is a xlsx file named <code>final_product_details.xlsx</code> with no issues.

**Note:**
In case you are getting unreadable and jibberish characters in csv, that's because excel uses different encoding than the data fetched. To convert the output excel file into UTF-8 encoding, follow the following steps:

1. Open **MS-Excel**
2. Go to **Data** -> **Get external data** -> **From text**
3. Navigate to the excel file generated by the script (product_details.csv) 
4. Click **Import**
5. Change file origin to **65001: Unicode (UTF-8)**
6. Click **Next**
7. Change delimiters from **Tab** to **Comma**.
8  Click **Next** -> **Finish** -> **Ok**
